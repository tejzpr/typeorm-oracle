{"version":3,"sources":["../../src/commands/VersionCommand.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAM,IAAI,GAAG,OAAO,CAAC,eAAe,CAAC,CAAC,IAAI,CAAC;AAE3C;;GAEG;AACH;IAAA;QACI,YAAO,GAAG,SAAS,CAAC;QACpB,aAAQ,GAAG,2CAA2C,CAAC;IAwC3D,CAAC;IAtCS,gCAAO,GAAb,UAAc,IAAS;;;;;4BAEE,qBAAM,cAAc,CAAC,cAAc,CAAC,oBAAoB,CAAC,EAAA;;wBAAxE,YAAY,GAAG,SAAyD;wBACxE,YAAY,GAAG,YAAY,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC;wBACrD,eAAe,GAAG,CAAC,YAAY,IAAI,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,aAAa,EAAE,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC;wBAE7F,qBAAM,cAAc,CAAC,cAAc,CAAC,uBAAuB,CAAC,EAAA;;wBAA5E,aAAa,GAAG,SAA4D;wBAC5E,aAAa,GAAG,aAAa,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC;wBACvD,gBAAgB,GAAG,CAAC,aAAa,IAAI,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,aAAa,EAAE,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC;wBAEvH,IAAI,eAAe,EAAE;4BACjB,OAAO,CAAC,GAAG,CAAC,0BAA0B,EAAE,eAAe,CAAC,CAAC;yBAC5D;6BAAM;4BACH,OAAO,CAAC,GAAG,CAAC,uCAAuC,CAAC,CAAC;yBACxD;wBACD,IAAI,gBAAgB,EAAE;4BAClB,OAAO,CAAC,GAAG,CAAC,mCAAmC,EAAE,gBAAgB,CAAC,CAAC;yBACtE;6BAAM;4BACH,OAAO,CAAC,GAAG,CAAC,gCAAgC,CAAC,CAAC;yBACjD;wBAED,IAAI,eAAe,IAAI,gBAAgB,IAAI,eAAe,KAAK,gBAAgB,EAAE;4BAC7E,OAAO,CAAC,GAAG,CAAC,0FAA0F;gCAClG,mEAAmE,CAAC,CAAC;yBAC5E;;;;;KACJ;IAEgB,6BAAc,GAA/B,UAAgC,OAAe;QAC3C,OAAO,IAAI,OAAO,CAAS,UAAC,EAAE,EAAE,IAAI;YAChC,IAAI,CAAC,OAAO,EAAE,UAAC,KAAU,EAAE,MAAW,EAAE,MAAW;gBAC/C,IAAI,MAAM;oBAAE,OAAO,EAAE,CAAC,MAAM,CAAC,CAAC;gBAC9B,IAAI,MAAM;oBAAE,OAAO,EAAE,CAAC,MAAM,CAAC,CAAC;gBAC9B,IAAI,KAAK;oBAAE,OAAO,IAAI,CAAC,KAAK,CAAC,CAAC;gBAC9B,EAAE,CAAC,EAAE,CAAC,CAAC;YACX,CAAC,CAAC,CAAC;QACP,CAAC,CAAC,CAAC;IACP,CAAC;IAEL,qBAAC;AAAD,CA1CA,AA0CC,IAAA;AA1CY,wCAAc","file":"VersionCommand.js","sourcesContent":["const exec = require(\"child_process\").exec;\r\n\r\n/**\r\n * Shows typeorm version.\r\n */\r\nexport class VersionCommand {\r\n    command = \"version\";\r\n    describe = \"Prints TypeORM version this project uses.\";\r\n\r\n    async handler(argv: any) {\r\n\r\n        const localNpmList = await VersionCommand.executeCommand(\"npm list --depth=0\");\r\n        const localMatches = localNpmList.match(/ typeorm@(.*)\\n/);\r\n        const localNpmVersion = (localMatches && localMatches[1] ? localMatches[1] : \"\").replace(/\"invalid\"/gi, \"\").trim();\r\n\r\n        const globalNpmList = await VersionCommand.executeCommand(\"npm list -g --depth=0\");\r\n        const globalMatches = globalNpmList.match(/ typeorm@(.*)\\n/);\r\n        const globalNpmVersion = (globalMatches && globalMatches[1] ? globalMatches[1] : \"\").replace(/\"invalid\"/gi, \"\").trim();\r\n\r\n        if (localNpmVersion) {\r\n            console.log(\"Local installed version:\", localNpmVersion);\r\n        } else {\r\n            console.log(\"No local installed TypeORM was found.\");\r\n        }\r\n        if (globalNpmVersion) {\r\n            console.log(\"Global installed TypeORM version:\", globalNpmVersion);\r\n        } else {\r\n            console.log(\"No global installed was found.\");\r\n        }\r\n\r\n        if (localNpmVersion && globalNpmVersion && localNpmVersion !== globalNpmVersion) {\r\n            console.log(\"To avoid issues with CLI please make sure your global and local TypeORM versions match, \" +\r\n                \"or you are using locally installed TypeORM instead of global one.\");\r\n        }\r\n    }\r\n\r\n    protected static executeCommand(command: string) {\r\n        return new Promise<string>((ok, fail) => {\r\n            exec(command, (error: any, stdout: any, stderr: any) => {\r\n                if (stdout) return ok(stdout);\r\n                if (stderr) return ok(stderr);\r\n                if (error) return fail(error);\r\n                ok(\"\");\r\n            });\r\n        });\r\n    }\r\n\r\n}"],"sourceRoot":".."}